# P2P Data Storage Architecture

## Принцип работы:

### 1. **Локальное хранение (приоритет)**
- Все данные пользователя хранятся на его устройстве
- Шифрование через ключ пользователя
- Быстрый доступ, полная приватность

### 2. **P2P синхронизация**
- При входе с нового устройства - запрос данных у доверенных пиров
- Данные передаются в зашифрованном виде
- Только пользователь может расшифровать свои данные

### 3. **Relay сервер (НЕ хранит данные)**
- Только передает сообщения между пирами
- Временная очередь для офлайн пользователей (1 час)
- Координация WebRTC соединений

## Что изменено:

### ✅ **relay-p2p.php** - новый relay сервер:
- Убрано хранение профилей, чатов, групп
- Только передача сообщений и координация пиров
- Временные очереди с автоочисткой

### ✅ **Обновлен config.ts**:
- Ссылка на новый relay-p2p.php
- Настройки для P2P архитектуры

### ✅ **Обновлен p2pNetwork.ts**:
- Интеграция с новым relay API
- Приоритет P2P, fallback на relay

## Деплой:

1. Загрузи `relay-p2p.php` на `bibliotekaznanyi.online`
2. Замени старый `relay.php` или используй новый URL
3. Данные пользователей остаются только у них локально

**Теперь relay сервер не хранит данные - только передает сообщения!**
